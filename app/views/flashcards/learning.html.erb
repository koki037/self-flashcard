<div class="container">
  <h2 class="mt-3">
    学習
  </h2>

  <table id="table" class="table-striped table-hover table-responsive learning-main">
    <tr>
      <th class="learning-first"><%= Flashcard.human_attribute_name(:category) %></th>
      <th class="learning-second"><%= Flashcard.human_attribute_name(:question) %></th>
      <th class="learning-third"><%= Flashcard.human_attribute_name(:answer) %></th>
      <th class="learning-forth"><%= Flashcard.human_attribute_name(:description) %></th>
      <th class="learning-fifth"><%= Flashcard.human_attribute_name(:answer) %>を確認</th>
      <th class="learning-sixth"></th>
    </tr>

    <% @flashcards.each do |flashcard| %>
    <tr>
      <td><%= flashcard.category %></td>
      <td><%= flashcard.question.reflect_newline %></td>
      <td><div class="answer-hidden"><%= flashcard.answer.reflect_newline %></div></td>
      <td><div class="discription-hidden"><%= flashcard.description.reflect_newline %></div></td>
      <td><input type="button" value="表示" onclick="toggleAnswerVisibility(this)" /></td>
      <td>
        <% if current_user.id == flashcard.user.id %>
          <div class="dropdown">
            <button class="btn btn-light dropdown-toggle" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
              ...
            </button>
            <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
              <%= link_to '編集', edit_flashcard_path(flashcard), class:"dropdown-item" %>
              <%= link_to "削除", flashcard_path(flashcard), method: :delete, class:"dropdown-item", data: {confirm: '本当に削除してよろしいですか？'} %>
            </ul>
          </div>
        <% end %>
      </td>
    </tr>
    <% end %>

  </table>
</div>


<script>
  function toggleAnswerVisibility(button) {
    const row = button.parentNode.parentNode;
    const answer = row.querySelector(".answer-hidden");
    const discription = row.querySelector(".discription-hidden");

    if (answer.style.visibility === "visible") {
      answer.style.visibility = "hidden";
    } else {
      answer.style.visibility = "visible";
    }
    if (discription.style.visibility === "visible") {
      discription.style.visibility = "hidden";
    } else {
      discription.style.visibility = "visible";
    }
  }
</script>